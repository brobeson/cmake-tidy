#!/usr/bin/env python3

import argparse
import os
import sys
import parameter_sorting

__version__ = '0.0.0'

def exit_if_arguments_are_invalid(arguments):
    if not os.path.isfile(arguments['files']):
        sys.exit('error: ' + arguments['files'] + ' does not exist.')

def make_parser():
    parser = argparse.ArgumentParser(
        description='Analyze CMake scripts for formatting and style mistakes.',)
    parser.add_argument('--version',
        action='version',
        version=__version__,
        help='Display the version, and exit.')
    parser.add_argument('files',
        default='./CMakeLists.txt',
        #nargs='*',
        help='The CMake files to analyze. The default is ./CMakeLists.txt')
    return parser

if __name__ == '__main__':
    parser = make_parser()
    arguments = vars(parser.parse_args())
    exit_if_arguments_are_invalid(arguments)

    with open(arguments['files'], 'r') as f:
        text = f.read()
    text = parameter_sorting.sort(text)
    print(text)
    sys.exit()
